<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Measure leaf area using leaf images • pliman</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Measure leaf area using leaf images">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pliman</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Image analysis</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/manipulation.html">Image manipulation</a></li>
    <li><a class="dropdown-item" href="../articles/indexes.html">Image indexes</a></li>
    <li><a class="dropdown-item" href="../articles/segmentation.html">Image segmentation</a></li>
    <li><a class="dropdown-item" href="../articles/polygons.html">Polygons</a></li>
    <li><a class="dropdown-item" href="../articles/analyze_objects.html">Image analysis</a></li>
    <li><a class="dropdown-item" href="../articles/leaf_area.html">Measure leaf area</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/phytopatometry.html">Phytopatometry</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/htp.html">High Throughput Phenotyping</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><a class="dropdown-item" href="../news/index.html">Package news</a></li>
    <li><a class="external-link dropdown-item" href="https://olivoto.netlify.app/">Blog posts</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">More</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-more">
<li><a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
    <li><a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../ISSUE_TEMPLATE.html">Issues</a></li>
    <li><a class="dropdown-item" href="../SUPPORT.html">Support</a></li>
    <li><a class="dropdown-item" href="../LICENSE.html">Licence</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Measure leaf area using leaf images</h1>
                        <h4 data-toc-skip class="author">Tiago
Olivoto</h4>
            
            <h4 data-toc-skip class="date">2024-11-01</h4>
      
      <small class="dont-index">Source: <a href="NA/NA/NA/blob/HEAD/vignettes/leaf_area.Rmd"><code>vignettes/leaf_area.Rmd</code></a></small>
      <div class="d-none name"><code>leaf_area.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>We can use <code><a href="../reference/analyze_objects.html">analyze_objects()</a></code> to compute object features
such as area, perimeter, radius, etc. This can be used, for example, to
compute leaf area. Let’s compute the leaf area of <code>leaves</code>
with <code><a href="../reference/analyze_objects.html">analyze_objects()</a></code>. First, we use
<code>image_segmentation()</code> to identify candidate indexes to
segment foreground (leaves) from background.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nepem-ufsc.github.io/pliman/">pliman</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; |======================================================|</span></span>
<span><span class="co">#&gt; | Welcome to the pliman package (version 3.0.0)!       |</span></span>
<span><span class="co">#&gt; | Developed collaboratively by NEPEM - nepemufsc.com   |</span></span>
<span><span class="co">#&gt; | Group lead: Prof. Tiago Olivoto                      |</span></span>
<span><span class="co">#&gt; | For citation: type `citation('pliman')`              |</span></span>
<span><span class="co">#&gt; | We welcome your feedback and suggestions!            |</span></span>
<span><span class="co">#&gt; |======================================================|</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/TiagoOlivoto/images/master/pliman"</span></span>
<span><span class="va">leaves</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/utils_image.html">image_import</a></span><span class="op">(</span><span class="st">"leaves2.jpg"</span>,</span>
<span>               path <span class="op">=</span> <span class="va">path</span>,</span>
<span>               plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="leaf_area_files/figure-html/leaf3-1.png" width="960"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/image_index.html">image_index</a></span><span class="op">(</span><span class="va">leaves</span><span class="op">)</span></span></code></pre></div>
<p><img src="leaf_area_files/figure-html/leaf4-1.png" width="768"></p>
<p><code>B</code> (Blue) and <code>NB</code> (Normalized Blue) are two
possible candidates to segment the leaves from the background. We will
use the <code>NB</code> index here (default option in
<code><a href="../reference/analyze_objects.html">analyze_objects()</a></code>). The measurement of the leaf area in
this approach can be done in two main ways: 1) using an object of known
area, and 2) knowing the image resolution in dpi (dots per inch).</p>
<div class="section level4">
<h4 id="using-an-object-of-known-area">Using an object of known area<a class="anchor" aria-label="anchor" href="#using-an-object-of-known-area"></a>
</h4>
<ul>
<li>Count the number of objects (leaves in this case)</li>
</ul>
<p>Here, we use the argument <code>marker = "id"</code> of the function
<code><a href="../reference/analyze_objects.html">analyze_objects()</a></code> to obtain the identification of each
object (leaf), allowing for further adjustment of the leaf area.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span>, marker <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<p><img src="leaf_area_files/figure-html/leaf5-1.png" width="960"></p>
<p>Note that “holes” in some leaves resulted in the segmentation of one
leaf in more than one object (e.g., 5, 8, 22, 25, 18, 28). This will not
affect the total leaf area, but the area of individual leaves and the
average leaf area. This can be solved by either setting the argument
<code>fill_hull = TRUE</code> or <code>watershed = FALSE</code> (To
don’t implement the watershed-based object segmentation). Let’s see how
much better we can go.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  fill_hull <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="leaf_area_files/figure-html/leaf6-1.png" width="960"></p>
<p>Almost there! Due to the morphology of the leaf composed by objects 2
and 23, it was segmented into two objects. This can be solved by setting
the argument <code>object_size = "large"</code> that will change the
default (medium) values for <code>tolerance</code> and
<code>extension</code> arguments.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span>,</span>
<span>                  marker <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>                  fill_hull <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  object_size <span class="op">=</span> <span class="st">"large"</span><span class="op">)</span></span></code></pre></div>
<p><img src="leaf_area_files/figure-html/leaf7-1.png" width="960"></p>
<p>When the objects are not touching each other, the argument
<code>watershed = FALSE</code> would be a better option.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/analyze_objects.html">analyze_objects</a></span><span class="op">(</span><span class="va">leaves</span>,</span>
<span>                watershed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="leaf_area_files/figure-html/leaf8-1.png" width="960"></p>
<p>And here we are! Now, all leaves were identified correctly, but all
measures were given in pixel units. The next step is to convert these
measures to metric units.</p>
<ul>
<li>Convert the leaf area by the area of the known object</li>
</ul>
<p>The function <code><a href="../reference/utils_measures.html">get_measures()</a></code> is used to adjust the leaf
area using object 10, a square with a side of 5 cm (25
cm<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mn>2</mn></msup><annotation encoding="application/x-tex">^2</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">count</span>,</span>
<span>               id <span class="op">=</span> <span class="fl">11</span>,</span>
<span>               <span class="va">area</span> <span class="op">~</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; measures corrected with:</span></span>
<span><span class="co">#&gt; object id: 11</span></span>
<span><span class="co">#&gt; area     : 25</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; Total    : 801.522 </span></span>
<span><span class="co">#&gt; Average  : 36.433 </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co"># plot the area to the segmented image</span></span>
<span><span class="fu"><a href="../reference/image_segment.html">image_segment</a></span><span class="op">(</span><span class="va">leaves</span>, index <span class="op">=</span> <span class="st">"NB"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">area</span>,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="co"># default is "white"</span></span></code></pre></div>
<p><img src="leaf_area_files/figure-html/leaf9-1.png" width="960"></p>
</div>
<div class="section level4">
<h4 id="knowing-the-image-resolution-in-dpi-dots-per-inch">knowing the image resolution in dpi (dots per inch)<a class="anchor" aria-label="anchor" href="#knowing-the-image-resolution-in-dpi-dots-per-inch"></a>
</h4>
<p>When the image resolution is known, the measures in pixels obtained
with <code><a href="../reference/analyze_objects.html">analyze_objects()</a></code> are corrected by the image
resolution. The function <code><a href="../reference/utils_dpi.html">dpi()</a></code> can be used to compute the
dpi of an image, provided that the size of any object is known. See the
<a href="#dpi">dpi</a> section for more details. In this case, the
estimated resolution considering the calibration of object 10 was ~50.5
DPIs. We inform this value in the <code>dpi</code> argument of
<code><a href="../reference/utils_measures.html">get_measures()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">area2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utils_measures.html">get_measures</a></span><span class="op">(</span><span class="va">count</span>, dpi <span class="op">=</span> <span class="fl">50.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">leaves</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/utils_measures.html">plot_measures</a></span><span class="op">(</span><span class="va">area2</span>,</span>
<span>              measure <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>              vjust <span class="op">=</span> <span class="op">-</span><span class="fl">60</span>,</span>
<span>              col <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="co"># default is "white"</span></span></code></pre></div>
<p><img src="leaf_area_files/figure-html/leaf10-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="a-little-bit-more">
<i class="fas fa-scroll"></i> A little bit more!<a class="anchor" aria-label="anchor" href="#a-little-bit-more"></a>
</h2>
<!-- inicio font awesome -->
<script src="https://kit.fontawesome.com/1f72d6921a.js" crossorigin="anonymous"></script><blockquote>
<p>At <a href="https://nepem-ufsc.github.io/paper_pliman/code.html" class="external-link">this
link</a> you will find more examples on how to use {pliman} to analyze
plant images. Source code and images can be downloaded <a href="https://github.com/TiagoOlivoto/paper_pliman/archive/refs/heads/master.zip" class="external-link">here</a>.
You can also find a talk (Portuguese language) about {pliman} <a href="https://www.youtube.com/watch?v=ElvUVlPocgA" class="external-link">here</a>.
<i class="far fa-lightbulb"></i>Lights,
<i class="fas fa-camera"></i>camera, {pliman}!</p>
</blockquote>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://olivoto.netlify.app/" class="external-link">Tiago Olivoto</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
